<script type="text/ng-template" id="program-selector">
    <div class="text-center">
        <select style="margin-top:0px;" ng-model="selectedProgram"
                class="form-control-program"
                ng-options="program as program.displayName for program in programs | orderBy: 'displayName'"
                ng-disabled="programs.length < 1"
                ng-change="applySelectedProgram(selectedProgram)">
            <option value="">{{programs.length > 0 ? 'please_select_a_program' : 'no_program_exists' |
                translate}}
            </option>
        </select>
    </div>
</script>
<div class="container-1-1">

    <!-- dashboard widgets begin -->
    <div class="col-sm-12" ng-if="metaDataCached">
        {{teststring}}
        <div class="row">
            <div style="display:flex;margin-left:15px;" class="vertical-spacing">
                <div><button type="button" class="btn btn-default remove-focus-effects dashboard-info-btn-left-back" ng-click="back()">
                        {{getBackButtonText()}}
                    </button>
                </div>
                <div ng-include="getTopBarView()" ng-if="topBarWidget" style="flex: 1 100%;" ng-init="topBarLoader = true"></div>
                <div ng-include="'program-selector'" ng-if="!topBarWidget" style="flex: 1 100%;"></div>
                <div ng-class="topbarRightSizeClass" style="width:150px">
                    <button type="button"
                            title="{{model.stickyDisabled ? stickLabel : unstickLabel}}"
                            ng-show="(dashboardWidgets | filter: {parent: 'smallerWidget', show: true}).length > 0"
                            class="btn btn-default dashboard-info-btn-right-size"
                            ng-class="{true: 'stick', false: 'unstick'} [!model.stickyDisabled]"
                            ng-click="model.stickyDisabled = !model.stickyDisabled">
                        <i class="fa fa-thumb-tack"></i>
                    </button>
                    
                    <div class="btn-group trim">
                        <button type="button" title="{{'manage' | translate}} {{trackedEntity.displayName}}" class="btn btn-danger dropdown-toggle" ng-disabled="selectedOrgUnit.closedStatus" data-toggle="dropdown">
                            <i class="fa fa-exclamation-circle"></i>
                        </button>
                        <ul class="dropdown-menu pull-right" role="menu">                            
                            <li><a href ng-click="activiateTEI()">{{selectedTei.inactive ? 'activate' : 'deactivate' | translate}} {{trackedEntity.displayName}}</a></li>
                            <li><a href ng-click="deleteTEI()">{{'delete' | translate}} {{trackedEntity.displayName}}</a></li>
                        </ul>
                    </div>
                    
                    <div class="btn-group trim">
                        <button type="button" title="{{settingsLabel}}" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-cog"></i>
                        </button>
                        <ul class="dropdown-menu pull-right" role="menu">
                            <li><a href ng-click="showHideWidgets()">{{showHideWidgetsLabel}}</a></li>
                            <li ng-if="userAuthority.canAdministerDashboard"><a href ng-click="saveDashboarLayoutAsDefault()">{{'save_layout_as_default' | translate}}</a></li>
                            <li ng-if="topBarWidget && topBarWidget.getTopBarFields" ng-click="openTopBarSettings()">Top bar settings</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div ng-if="topBarWidget" ng-include="'program-selector'"></div>
        </div>
        <div class="row">
            <!-- dashboard bigger widgets begin -->
            <div ng-class="widgetSize.bigger">

                <div id="biggerWidget" class="row connectedSortable empty-dashboard-container" d2-sortable
                     bigger-widgets={{dashboardWidgets | filter: {parent:
                'biggerWidget'}}} smaller-widgets={{ dashboardWidgets | filter: {parent: 'smallerWidget'}}}>
                <div class="col-sm-12 remove-one-pix" id={{biggerWidget.title}}
                     ng-repeat="biggerWidget in dashboardWidgets | orderBy:'order' | filter: {parent: 'biggerWidget'}">
                    <div ng-show="(!biggerWidget.useAsTopBar && biggerWidget.show && !temporaryHideWidgets[biggerWidget.title]) || temporaryShowWidgets[biggerWidget.title]"
                         ng-include="biggerWidget.view"
                         ng-class="{true: 'hideInPrint'} [biggerWidget.title != 'report']">
					</div>
                </div>
            </div>
        </div>
        <!-- dashboard bigger widgets end -->

        <!-- dashboard smaller widgets begin -->
        <div ng-class="[!model.stickyDisabled ? 'widgets-sticky' : '', widgetSize.smaller]">
            <!-- dashboard setting begins -->
            <div class="row add-default-right-padding vertical-spacing" ng-if="!useTopBar">
                <div class="pull-right">
                    <button type="button"
                            title="{{model.stickyDisabled ? stickLabel : unstickLabel}}"
                            ng-show="(dashboardWidgets | filter: {parent: 'smallerWidget', show: true}).length > 0"
                            class="btn btn-default"
                            ng-class="{true: 'stick', false: 'unstick'} [!model.stickyDisabled]"
                            ng-click="model.stickyDisabled = !model.stickyDisabled">
                        <i class="fa fa-thumb-tack"></i>
                    </button>
                    
                    <div class="btn-group trim">
                        <button type="button" title="{{'manage' | translate}} {{trackedEntity.displayName}}" ng-disabled="selectedOrgUnit.closedStatus" class="btn btn-danger dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-exclamation-circle"></i>
                        </button>
                        <ul class="dropdown-menu pull-right" role="menu">                            
                            <li><a href ng-click="activiateTEI()">{{selectedTei.inactive ? 'activate' : 'deactivate' | translate}} {{trackedEntity.displayName}}</a></li>
                            <li><a href ng-click="deleteTEI()">{{'delete' | translate}} {{trackedEntity.displayName}}</a></li>
                        </ul>
                    </div>
                    
                    <div class="btn-group trim">
                        <button type="button" title="{{settingsLabel}}" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-cog"></i>
                        </button>
                        <ul class="dropdown-menu pull-right" role="menu">
                            <li><a href ng-click="showHideWidgets()">{{showHideWidgetsLabel}}</a></li>
                            <li ng-if="userAuthority.canAdministerDashboard"><a href ng-click="saveDashboarLayoutAsDefault()">{{'save_layout_as_default' | translate}}</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- dashboard setting ends -->

            <div id="smallerWidget" class="row connectedSortable empty-dashboard-container" d2-sortable
                 bigger-widgets={{dashboardWidgets | filter: {parent:
            'biggerWidget'}}} smaller-widgets={{dashboardWidgets | filter: {parent: 'smallerWidget'}}}>
            <div class="col-sm-12 remove-one-pix" id={{smallerWidget.title}}
                 ng-repeat="smallerWidget in dashboardWidgets  | orderBy:'order' | filter: {parent: 'smallerWidget'}">
                <div ng-show="(!smallerWidget.useAsTopBar && smallerWidget.show && !temporaryHideWidgets[smallerWidget.title]) || temporaryShowWidgets[smallerWidget.title]"
                     ng-include="smallerWidget.view"
                     ng-class="{true: 'hideInPrint'} [smallerWidget.title != 'report']"></div>
            </div>
        </div>
        <!-- dashboard smaller widgets end -->


    </div>
    </div>
    </div>

    <!-- dashboard widgets end -->


    <div class="col-sm-12" ng-if="!metaDataCached">
        <img src="../images/ajax-loader-bar.gif" alt="{{'in_progress'| translate}}"/><br>
            {{'loading_metadata'| translate}}
    </div>

</div>

